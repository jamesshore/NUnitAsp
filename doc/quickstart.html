<html>
  <head>
    <title>NUnitAsp - ASP.NET unit testing - Quick Start Guide</title>
		<link rel="stylesheet" type="text/css" href="style.css">
		<style>
			.highlight {
				background-color: yellow;
				font-weight: bold;
			}
		</style>
  </head>
  <body>
		<p class="title">NUnitAsp
		<br /><small>ASP.NET unit testing</small></p>

		<table class="layout">
			<tr>
				<td>
					<div class="menu">
						<p><a href="download.html"><b>Download</b></a></p>
						<p>
							<a href="index.html">Overview</a>
							<br /><a href="documentation.html">Documentation</a>
							<br /><a href="support.html">Support</a>
							<br /><a href="consulting.html">Training and Consulting</a>
						</p>
						<p><a href="contribute.html">Contribute</p>
						<p><A href="http://sourceforge.net/projects/nunitasp/"><IMG src=
						"http://sourceforge.net/sflogo.php?group_id=49940" width="88" height="31" border="0" alt="SourceForge Logo"></A></p>
					</div>
				</td>
				<td>
					<div class="content">
						<h1>Quick Start Guide</h1>

						<p>This guide contains a brief description of NUnitAsp and how to use it.  It assumes that you're familiar with NUnit, ASP.NET, and unit testing.  It also assumes that you're comfortable with a high-level explanation and can look up the <a href="api/index.html">API details</a> for yourself.  If you prefer a more detailed explanation, see the <a href="tutorial/index.html">NUnitAsp Tutorial</a> instead.</p>

						<p>The examples in this guide are written in C#.  NUnitAsp will work with other .NET languages, but we don't provide examples for them.  If you would like us to include examples for your favorite language, we welcome <a href="contribute.html">contributions</a>.</p>

						<h2>About NUnitAsp</h2>

						<p>NUnitAsp is a class library for use within your NUnit tests.  It provides NUnit with the ability to download, parse, and manipulate ASP.NET web pages.</p>

						<p>When you use NUnitAsp, you'll create NUnit test fixtures and test cases as normal.  Each test case will consist of three parts.  The first part sets up the test by instantiating "Tester" objects that know how to parse ASP.NET.  The second part loads the page from the web server, and the third part performs the test by using and making assertions about the testers.</p>

						<p class="code">
							<span class="keyword">public void</span> TestExample()
							<br />{
							<br />&nbsp;&nbsp;&nbsp;<span class="comment">// First, instantiate "Tester" objects:</span>
							<br />&nbsp;&nbsp;&nbsp;LabelTester label = <span class="keyword">new</span> LabelTester("textLabel", CurrentWebForm);
							<br />&nbsp;&nbsp;&nbsp;LinkButtonTester link = <span class="keyword">new</span> LinkButtonTester("linkButton", CurrentWebForm);
							<br />
							<br />&nbsp;&nbsp;&nbsp;<span class="comment">// Second, visit the page being tested:</span>
							<br />&nbsp;&nbsp;&nbsp;Browser.GetPage("http://localhost/example/example.aspx");
							<br />
							<br />&nbsp;&nbsp;&nbsp;<span class="comment">// Third, use tester objects to test the page:</span>
							<br />&nbsp;&nbsp;&nbsp;AssertEquals("Not clicked.", label.Text);
							<br />&nbsp;&nbsp;&nbsp;link.Click();
							<br />&nbsp;&nbsp;&nbsp;AssertEquals("Clicked once.", label.Text);
							<br />&nbsp;&nbsp;&nbsp;link.Click();
							<br />&nbsp;&nbsp;&nbsp;AssertEquals("Clicked twice.", label.Text);
							<br />}
						</p>

						<h2>An NUnitAsp Test Fixture</h2>

						<p>Every NUnitAsp test fixture follows the following basic pattern.  NUnit will automatically find the tests when you load their DLL.  Replace the parts that are <span class="highlight">highlighted</span>.</p>

						<p class="code">
							<span class="keyword">using</span> System;
							<br /><span class="keyword">using</span> NUnit.Framework;
							<br /><span class="keyword">using</span> NUnit.Extensions.Asp;
							<br /><span class="keyword">using</span> NUnit.Extensions.Asp.AspTester;
							<br />
							<br /><span class="keyword">namespace</span> <span class="highlight">example.namespace</span>
							<br />{
							<br />&nbsp;&nbsp;[TestFixture]
							<br />&nbsp;&nbsp;<span class="keyword">public class</span> <span class="highlight">ExampleTestFixture</span> : WebFormTestCase
							<br />&nbsp;&nbsp;{
							<br />&nbsp;&nbsp;&nbsp;&nbsp;[Test]
							<br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span> void <span class="highlight">TestExample</span>()
							<br />&nbsp;&nbsp;&nbsp;&nbsp;{
							<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment"><span class="highlight">// Your test here</span></span>
							<br />&nbsp;&nbsp;&nbsp;&nbsp;}
							<br />
							<br />&nbsp;&nbsp;&nbsp;&nbsp;[Test]
							<br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span> void <span class="highlight">TestExample2</span>()
							<br />&nbsp;&nbsp;&nbsp;&nbsp;{
							<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment"><span class="highlight">// Your second test here</span></span>
							<br />&nbsp;&nbsp;&nbsp;&nbsp;}
							<br />
							<br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment"><span class="highlight">// etc...</span></span>
							<br />
							<br />&nbsp;&nbsp;}
							<br />}
						</p>

						<h2>About WebFormTestCase</h2>

						<p>NUnitAsp test fixtures extend WebFormTestCase.  It provides a number of <a href="api/NUnit.Extensions.Asp.WebFormTestCaseMembers.html">useful asserts</a>, which I recommend reviewing.  It also provides the Browser property.</p>

						<p>The Browser object represents the NUnitAsp web browser.  You'll use it to load your page in order to start testing it.  Browser is important, but in most of your tests, you'll just use it for that one thing:

						<p class="code">Browser.GetPage("http://localhost/example/example.aspx");</p>

						<p>The Browser property on WebFormTestCase is what you'll typically use, but the object itself is an instance of HttpClient, an NUnitAsp class.  You might find yourself using HttpClient's <a href="api/NUnit.Extensions.Asp.HttpClientMembers.html">other capabilities</a> occasionally.  HttpClient's <a href="api/NUnit.Extensions.Asp.HttpClient.CurrentPageText.html">CurrentPageText</a> property can be particularly useful.  Use it to help debug: dump the text of the current page to the console, and then look at NUnit's "Standard Out" tab to see what the problem is.</p>

						<p class="code">Console.WriteLine(Browser.CurrentPageText);</p>

						<h2>About Tester Objects</h2>

						<p>Tester objects form the core of NUnitAsp.  Each instantiated tester object represents exactly one ASP.NET control in your web page.  With a tester object, you can manipulate the ASP.NET control as if you were actually receiving a .aspx page (rather than some badly mangled HTML).</p>

						<p class="code">
							AssertEquals("Not clicked.", label.Text);
							<br />link.Click();
							<br />AssertEquals("Clicked once.", label.Text);
							<br />link.Click();
							<br />AssertEquals("Clicked twice.", label.Text);
						</p>

						<p>In the above example, both "label" and "link" are testers.  "Label" is an instance of a the LabelTester tester and "link" is an instance of the LinkButtonTester.  As you can see from the example, the tester allows you to directly manipulate the underlying controls.  You can read the text from the label and you can click the link button.</p>

						<p>In order to use a tester object, you must first instantiate it.  Provide the ID of the control you want to test and a tester for the control it's embedded in.</p>

						<p class="code">
							LabelTester label = <span class="keyword">new</span> LabelTester("textLabel", CurrentWebForm);
							<br />LinkButtonTester link = <span class="keyword">new</span> LabelTester("textLabel", CurrentWebForm);
						</p>

						<p>The first parameter is the ID attribute you specify in your ASP.NET code.  The second parameter, the container for your control, confuses a lot of people.  If you just have simple pages, you can safely ignore it.  Just use "CurrentWebForm."</p>

						<p>If you have a more complex web site, though, you'll need to specify a value.  For example, if you're testing a link button that's in a user control, you have to tell NUnitAsp that the link is inside the user control.  If you have a checkbox inside a data grid, you have to tell NUnitAsp that the checkbox is inside the datagrid, and even which row it's in.  If you don't, NUnitAsp won't be able to find it for you.</p>

						<p class="code">
							<span class="comment">// Example: Link button in a user control in the web page</span>
							<br />UserControlTester control = <span class="keyword">new</span> UserControlTester("control", CurrentWebPage);
							<br />LinkButtonTester button = <span class="keyword">new</span> LinkButtonTester("button", control);
							<br />
							<br /><span class="comment">// Example: Checkbox in row 3 of a data grid, in a user control, in the web page</span>
							<br />UserControlTester control = <span class="keyword">new</span> UserControlTester("control", CurrentWebPage);
							<br />DataGridTester grid = <span class="keyword">new</span> DataGridTester("grid", control);
							<br />DataGridTester.Row row3 = <span class="keyword">new</span> DataGridTester.Row(3, grid);
							<br />CheckBoxTester checkbox = <span class="keyword">new</span> CheckBoxTester("checkbox", row3);
						</p>

						<p>For information about which controls are supported, see the <a href="api/index.html">API documentation</a>.  Testers for web controls are in the <a href="api/NUnit.Extensions.Asp.AspTester.html">AspTester</a> namespace and testers for HTML controls are in the <a href="api/NUnit.Extensions.Asp.HtmlTester.html">HtmlTester</a> namespace.</p>

						<h2>SetUp And TearDown</h2>

						<p>A standard feature of NUnit is the ability to perform pre-test and post-test actions with the [SetUp] and [TearDown] attributes.  Those actions work a little bit differently than normal in NUnitAsp.  This is a flaw in NUnitAsp and we hope to fix it some day.</p>

						<p>In NUnitAsp, the [SetUp] and [TearDown] attributes are already used by WebFormTestCase.  Using them again in a your own test fixture will cause NUnit to ignore the code in WebFormTestCase.  This prevents important set-up code from running.  Fortunately for your sanity, NUnitAsp will throw an exception explaining the problem if you accidently use one of these inappropriately.</p>

						<p>Because [SetUp] and [TearDown] are not available, NUnitAsp uses the old NUnit 1.x approach of overriding SetUp() and TearDown() <i>methods</i> instead.

						<p class="code">
							<span class="comment">// <b>Don't</b> do this:</span>
							<br /><strike>[SetUp]
							<br />public void MySetUp() {
							<br />&nbsp;&nbsp;<span class="comment">// set-up code here</span>
						  <br />}
							<br />
						  <br />[TearDown]
						  <br />public void MyTearDown() {
						  <br />&nbsp;&nbsp;<span class="comment">// tear-down code here</span>
						  <br />}
						  </strike>
							<br />
						  <br /><span class="comment">// Do this instead:</span>
							<br />protected override void SetUp() {
							<br />&nbsp;&nbsp;<span class="comment">// set-up code here</span>
						  <br />}
							<br />
						  <br />protected override void TearDown() {
						  <br />&nbsp;&nbsp;<span class="comment">// tear-down code here</span>
						  <br />}
						</p>

						<h2>XHTML Compliance</h2>

						<p>Internally, NUnitAsp requires your web pages to be XHTML compliant so it can parse them.  (Specifically, XHTML 1.0 Transitional.)  NUnitAsp automatically fixes a number of XHTML non-compliance issues before parsing, particularly ones generated by Visual Studio .NET and ASP.NET, so you're not as likely to see an error from this as a result.</p>

						<p>However, you will probably see parse errors from NUnitAsp eventually.  If you do, check your HTML to make sure it's well-formed.  Here's a checklist to reference:</p>

						<ul>
							<li>Do all of your tags have corresponding end tags?</li>
							<li>Are you using the entities "&amp;amp;" and "&amp;lt;" instead of the characters "&amp;" and "&lt;"?</li>
							<li>Do all attributes have a value?  For example, are you using <code>&lt;input type="checkbox" <b>checked="true"</b>></code> instead of <code>&lt;input type="checkbox" <b>checked</b>></code>?</li>
							<li>Do you have quotes around attribute values?  For example, are you using <code>&lt;td nowrap="true"></code> instead of <code>&lt;td nowrap=true></code>?</li>
							<li>Are tags nested, not overlapping?  For example, are you using <code>&lt;b&gt;&lt;i&gt;text&lt;/i&gt;&lt;/b&gt;</code> instead of <code>&lt;b&gt;&lt;i&gt;text&lt;/b&gt;&lt;/i&gt;</code>?</li>
						</ul>

						<h2>Conclusion</h2>

						<p>NUnitAsp is meant to make it easy for you to test your ASP.NET applications.  The basic structure of each test is to instantiate tester objects, get a web page with the Browser object, and then manipulate and assert the page by using the testers.</p>

						<p>As you work, remember NUnitAsp's two primary "gotchas:" override SetUp() and TearDown() instead of using the [SetUp] and [TearDown] attributes.  If you run into a parse error, double-check your code for XHTML compliance.</p>

						<p>We welcome your feedback on NUnitAsp.  Please send email to the NUnitAsp <a href="http://sourceforge.net/mail/?group_id=49940">mailing list</a>.</p>

						<p class="end">by Jim Little.  Last updated for v1.3.</p>
					</div>
				</td>
			</tr>
		</table>
	</body>
</html>